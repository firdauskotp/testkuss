<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Data</title>
  <link rel="icon" href="{{ url_for('static', filename='logo.jpg') }}" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <div class="container mt-5 position-relative">
            <!-- Button Positioned Top Right -->
            <a href="{{ url_for('dashboard') }}" class="btn btn-danger position-absolute top-0 end-0 m-3">Back</a>
    
            <h1>All - Data</h1>
        </div>

        <form class="mb-4" method="get" action="/all-list">


        <div class="accordion" id="responsiveAccordion">
            <div class="accordion-item">
                <h2 class="accordion-header" id="formHeader">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#formContent" aria-expanded="true" aria-controls="formContent">
                        Filter
                    </button>
                </h2>
                <div id="formContent" class="accordion-collapse collapse show" aria-labelledby="formHeader" data-bs-parent="#responsiveAccordion">
                    <div class="accordion-body">
    
            
            <div class="row">
                <div class="col-md-3">
                    <label for="month" class="form-label">Month (Fill in the year too)</label>
                    <input type="text" id="month" name="month" class="form-control" placeholder="10">
                </div>
                <div class="col-md-3">
                    <label for="year" class="form-label">Year (Fill in the month too)</label>
                    <input type="number" id="year" name="year" class="form-control" placeholder="2024">
                </div>
                <div class="col-md-3">
                    <label for="Company" class="form-label">Company Name</label>
                    <input type="text" id="Company" name="Company" class="form-control" placeholder="Valencia">
                </div>
                <div class="col-md-3">
                    <label for="Model" class="form-label">Model</label>
                    <input type="text" id="Model" name="Model" class="form-control" placeholder="VOX">
                </div>
                <div class="col-md-3">
                    <label for="Colour" class="form-label">Colour (First Letter of Colour)</label>
                    <input type="text" id="Colour" name="Colour" class="form-control" placeholder="R">
                </div>
                <div class="col-md-3">
                    <label for="EO" class="form-label">EO</label>
                    <input type="text" id="EO" name="EO" class="form-control" placeholder="Black Opium">
                </div>
                <div class="col-md-3">
                    <label for="Volume" class="form-label">Volume</label>
                    <input type="number" id="Volume" name="Volume" class="form-control" placeholder="10">
                </div>
                <div class="col-md-3">
                    <label for="SN" class="form-label">S/N</label>
                    <input type="number" id="SN" name="SN" class="form-control" placeholder="12345">
                </div>
                <div class="col-md-3">
                    <label for="Balance" class="form-label">Balance</label>
                    <input type="number" id="Balance" name="Balance" class="form-control" placeholder="10">
                </div>
                <div class="col-md-3">
                    <label for="Consumption" class="form-label">Consumption</label>
                    <input type="number" id="Consumption" name="Consumption" class="form-control" placeholder="10">
                </div>
                <div class="col-md-3">
                    <label for="Refilled" class="form-label">Refilled</label>
                    <input type="number" id="Refilled" name="Refilled" class="form-control" placeholder="10">
                </div>
                <div class="col-md-3">
                    <label for="E1_Days" class="form-label">E1-Days</label>
                    <input type="text" id="E1_Days" name="E1_Days" class="form-control" placeholder="1,2,3,4,5">
                </div>
                <div class="col-md-3">
                    <label for="E1_Start" class="form-label">E1-Start</label>
                    <input type="text" id="E1_Start" name="E1_Start" class="form-control" placeholder="9:00:00">
                </div>
                <div class="col-md-3">
                    <label for="E1_End" class="form-label">E1-End</label>
                    <input type="text" id="E1_End" name="E1_End" class="form-control" placeholder="12:00:00">
                </div>
                <div class="col-md-3">
                    <label for="E1_Work" class="form-label">E1-Work</label>
                    <input type="number" id="E1_Work" name="E1_Work" class="form-control" placeholder="100">
                </div>
                <div class="col-md-3">
                    <label for="E1_Pause" class="form-label">E1-Pause</label>
                    <input type="number" id="E1_Pause" name="E1_Pause" class="form-control" placeholder="120">
                </div>
                
                
                <!-- E2 -->
                <div class="col-md-3">
                    <label for="E2_Days" class="form-label">E2-Days</label>
                    <input type="text" id="E2_Days" name="E2_Days" class="form-control" placeholder="1,2,3,4,5">
                </div>
                <div class="col-md-3">
                    <label for="E2_Start" class="form-label">E2-Start</label>
                    <input type="text" id="E2_Start" name="E2_Start" class="form-control" placeholder="9:00:00">
                </div>
                <div class="col-md-3">
                    <label for="E2_End" class="form-label">E2-End</label>
                    <input type="text" id="E2_End" name="E2_End" class="form-control" placeholder="12:00:00">
                </div>
                <div class="col-md-3">
                    <label for="E2_Work" class="form-label">E2-Work</label>
                    <input type="number" id="E2_Work" name="E2_Work" class="form-control" placeholder="100">
                </div>
                <div class="col-md-3">
                    <label for="E2_Pause" class="form-label">E2-Pause</label>
                    <input type="number" id="E2_Pause" name="E2_Pause" class="form-control" placeholder="120">
                </div>
                
                <!-- E3 -->
                <div class="col-md-3">
                    <label for="E3_Days" class="form-label">E3-Days</label>
                    <input type="text" id="E3_Days" name="E3_Days" class="form-control" placeholder="1,2,3,4,5">
                </div>
                <div class="col-md-3">
                    <label for="E3_Start" class="form-label">E3-Start</label>
                    <input type="text" id="E3_Start" name="E3_Start" class="form-control" placeholder="9:00:00">
                </div>
                <div class="col-md-3">
                    <label for="E3_End" class="form-label">E3-End</label>
                    <input type="text" id="E3_End" name="E3_End" class="form-control" placeholder="12:00:00">
                </div>
                <div class="col-md-3">
                    <label for="E3_Work" class="form-label">E3-Work</label>
                    <input type="number" id="E3_Work" name="E3_Work" class="form-control" placeholder="100">
                </div>
                <div class="col-md-3">
                    <label for="E3_Pause" class="form-label">E3-Pause</label>
                    <input type="number" id="E3_Pause" name="E3_Pause" class="form-control" placeholder="200">
                </div>
                
                <!-- E4 -->
                <div class="col-md-3">
                    <label for="E4_Days" class="form-label">E4-Days</label>
                    <input type="text" id="E4_Days" name="E4_Days" class="form-control" placeholder="1,2,3,4,5">
                </div>
                <div class="col-md-3">
                    <label for="E4_Start" class="form-label">E4-Start</label>
                    <input type="text" id="E4_Start" name="E4_Start" class="form-control" placeholder="9:00:00">
                </div>
                <div class="col-md-3">
                    <label for="E4_End" class="form-label">E4-End</label>
                    <input type="text" id="E4_End" name="E4_End" class="form-control" placeholder="12:00:00">
                </div>
                <div class="col-md-3">
                    <label for="E4_Work" class="form-label">E4-Work</label>
                    <input type="number" id="E4_Work" name="E4_Work" class="form-control" placeholder="100">
                </div>
                <div class="col-md-3">
                    <label for="E4_Pause" class="form-label">E4-Pause</label>
                    <input type="number" id="E4_Pause" name="E4_Pause" class="form-control" placeholder="120">
                </div>
                
                <div class="col-md-3">
                    <label for="Scent_Effectiveness" class="form-label">Scent Effectiveness</label>
                    <input type="text" id="Scent_Effectiveness" name="Scent_Effectiveness" class="form-control" placeholder="Scent Effectiveness">
                </div>
                <div class="col-md-3">
                    <label for="Common_Encounters" class="form-label">Common Encounters</label>
                    <input type="text" id="Common_Encounters" name="Common_Encounters" class="form-control" placeholder="Common Encounters">
                </div>
                <div class="col-md-3">
                    <label for="Other_Remarks" class="form-label">Other Remarks</label>
                    <input type="text" id="Other_Remarks" name="Other_Remarks" class="form-control" placeholder="Other Remarks">
                </div>

                <button type="submit" class="btn btn-primary mt-3">Filter</button>
            </div>
            
    </div>
</div>
</div>
</div>
</form>
    
        <!-- Data Table -->
        <div class="table-responsive">
            <table class="table table-striped table-bordered">
                <thead class="table-dark">
                    <tr>
                        <th>Company</th>
                        <th>Premise Name</th>
                        <th>Model</th>
                        <th>Colour</th>
                        <th>S/N</th>
                        <th>Volume</th>
                        <th>Current EO</th>
                        <th>Balance</th>
                        <th>Consumption</th>
                        <th>New EO</th>
                        <th>Refilled</th>
                        <th>E1-Days</th>
                        <th>E1-Start</th>
                        <th>E1-End</th>
                        <th>E1-Work</th>
                        <th>E1-Pause</th>
                        <th>E2-Days</th>
                        <th>E2-Start</th>
                        <th>E2-End</th>
                        <th>E2-Work</th>
                        <th>E2-Pause</th>
                        <th>E3-Days</th>
                        <th>E3-Start</th>
                        <th>E3-End</th>
                        <th>E3-Work</th>
                        <th>E3-Pause</th>
                        <th>E4-Days</th>
                        <th>E4-Start</th>
                        <th>E4-End</th>
                        <th>E4-Work</th>
                        <th>E4-Pause</th>
                        <th>Scent Effectiveness</th>
                        <th>Common Encounters</th>
                        <th>Other Remarks</th>
                        <th>Month</th>
                        <th>Year</th>
                        <!-- <th>Edit</th> -->
                    </tr>
                </thead>
                <tbody>
                    {% for user in data %}
                    <tr data-id="{{ user['_id'] }}"
                    data-company="{{ user['company'] }}"
                    data-premise-name="{{ user['Premise Name'] }}"
                    data-model="{{ user['Model'] }}"
                    data-color="{{ user['Color'] }}"
                    data-sn="{{ user['S/N'] }}"
                    data-volume="{{ user['Volume'] }}"
                    data-current-eo="{{ user['Current EO'] }}"
                    data-balance="{{ user['Balance'] }}"
                    data-consumption="{{ user['Consumption'] }}"
                    data-new-eo="{{ user['New EO'] }}"
                    data-refilled="{{ user['Refilled'] }}"
                    data-scent-effectiveness="{{ user['#1 Scent Effectiveness'] }}"
                    data-common-encounters="{{ user['#1 Common encounters'] }}"
                    data-other-remarks="{{ user['#1 Other remarks'] }}"
                    data-month="{{ user['month'] }}"
                    data-year="{{ user['year'] }}">
                        <td>{{ user['company'] }}</td>

                      <td>{{ user['Premise Name'] }}</td>
                        <td>{{ user['Model'] }}</td>
                        <td>{{ user['Color'] }}</td>
                        <td>{{ user['S/N'] }}</td>
                        <td>{{ user['Volume'] }}</td>
                        <td>{{ user['Current EO'] }}</td>
                        <td>{{ user['Balance'] }}</td>
                        <td>{{ user['Consumption'] }}</td>
                        <td>{{ user['New EO'] }}</td>
                        <td>{{ user['Refilled'] }}</td>
                        <td>{{ user['E1 - DAYS'] }}</td>
                        <td>{{ user['E1 - START'] }}</td>
                        <td>{{ user['E1 - END'] }}</td>
                        <td>{{ user['E1 - WORK'] }}</td>
                        <td>{{ user['E1 - PAUSE'] }}</td>
                        <td>{{ user['E2 - DAYS'] }}</td>
                        <td>{{ user['E2 - START'] }}</td>
                        <td>{{ user['E2 - END'] }}</td>
                        <td>{{ user['E2 - WORK'] }}</td>
                        <td>{{ user['E2 - PAUSE'] }}</td>
                        <td>{{ user['E3 - DAYS'] }}</td>
                        <td>{{ user['E3 - START'] }}</td>
                        <td>{{ user['E3 - END'] }}</td>
                        <td>{{ user['E3 - WORK'] }}</td>
                        <td>{{ user['E3 - PAUSE'] }}</td>
                        <td>{{ user['E4 - DAYS'] }}</td>
                        <td>{{ user['E4 - START'] }}</td>
                        <td>{{ user['E4 - END'] }}</td>
                        <td>{{ user['E4 - WORK'] }}</td>
                        <td>{{ user['E4 - PAUSE'] }}</td>
                        <td>{{ user['#1 Scent Effectiveness'] }}</td>
                        <td>{{ user['#1 Common encounters'] }}</td>
                        <td>{{ user['#1 Other remarks'] }}</td>
                        <td>{{ user['month'] }}</td>
                        <td>{{ user['year'] }}</td>
                        <!-- <td>
                            <button class="btn btn-primary btn-sm edit-btn" data-bs-toggle="modal" data-bs-target="#editModal">Edit</button>
                        </td> -->
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    
        <!-- Pagination Controls -->
        <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center mt-4">
                <!-- Previous Button -->
                <li class="page-item {% if page == 1 %}disabled{% endif %}">
                    <a class="page-link" 
                       href="{{ pagination_base_url }}{{ query_params | to_querystring | update_querystring('page', page - 1) }}" 
                       aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>
        
                <!-- First Page and Ellipsis -->
                {% if page > 4 %}
                <li class="page-item">
                    <a class="page-link" 
                    href="{{ pagination_base_url }}{{ query_params | to_querystring | update_querystring('page', 1) }}">1</a>
                </li>
                <li class="page-item disabled d-none d-sm-inline">
<span class="page-link">...</span>                </li>
                {% endif %}

                <!-- Dynamic Page Numbers -->
                {% for p in range(max(1, page - 2), min(total_pages + 1, page + 3)) %}
                <li class="page-item {% if p == page %}active{% endif %} d-none d-sm-inline">
                    <a class="page-link" 
                    href="{{ pagination_base_url }}{{ query_params | to_querystring | update_querystring('page', p) }}">
                        {{ p }}
                    </a>
                </li>
                {% endfor %}

                <!-- Ellipsis and Last Page -->
                {% if page < total_pages - 3 %}
                <li class="page-item disabled d-none d-sm-inline">
                    <span class="page-link">...</span>
                </li>
                <li class="page-item">
                    <a class="page-link" 
                    href="{{ pagination_base_url }}{{ query_params | to_querystring | update_querystring('page', total_pages) }}">
                        {{ total_pages }}
                    </a>
                </li>
                {% endif %}
        
                <!-- Next Button -->
                <li class="page-item {% if page == total_pages %}disabled{% endif %}">
                    <a class="page-link" 
                       href="{{ pagination_base_url }}{{ query_params | to_querystring | update_querystring('page', page + 1) }}" 
                       aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            </ul>
        </nav>
        
    </div>

    <!-- Edit Modal -->
    <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editModalLabel">Edit Record</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editForm">
                        <input type="hidden" id="recordId">
                
                        <!-- Company and Premise Name -->
                        <div class="mb-3">
                            <label for="company" class="form-label">Company</label>
                            <input type="text" class="form-control" id="company">
                        </div>
                        <div class="mb-3">
                            <label for="premiseName" class="form-label">Premise Name</label>
                            <input type="text" class="form-control" id="premiseName">
                        </div>
                
                        <!-- E1 to E4 Fields -->
                        <div class="mb-3">
                            <label for="e1Days" class="form-label">E1-Days</label>
                            <input type="number" class="form-control" id="e1Days">
                        </div>
                        <div class="mb-3">
                            <label for="e1Start" class="form-label">E1-Start</label>
                            <input type="datetime-local" class="form-control" id="e1Start">
                        </div>
                        <div class="mb-3">
                            <label for="e1End" class="form-label">E1-End</label>
                            <input type="datetime-local" class="form-control" id="e1End">
                        </div>
                        <div class="mb-3">
                            <label for="e1Work" class="form-label">E1-Work</label>
                            <input type="number" class="form-control" id="e1Work">
                        </div>
                        <div class="mb-3">
                            <label for="e1Pause" class="form-label">E1-Pause</label>
                            <input type="number" class="form-control" id="e1Pause">
                        </div>
                
                        <div class="mb-3">
                            <label for="e2Days" class="form-label">E2-Days</label>
                            <input type="number" class="form-control" id="e2Days">
                        </div>
                        <div class="mb-3">
                            <label for="e2Start" class="form-label">E2-Start</label>
                            <input type="datetime-local" class="form-control" id="e2Start">
                        </div>
                        <div class="mb-3">
                            <label for="e2End" class="form-label">E2-End</label>
                            <input type="datetime-local" class="form-control" id="e2End">
                        </div>
                        <div class="mb-3">
                            <label for="e2Work" class="form-label">E2-Work</label>
                            <input type="number" class="form-control" id="e2Work">
                        </div>
                        <div class="mb-3">
                            <label for="e2Pause" class="form-label">E2-Pause</label>
                            <input type="number" class="form-control" id="e2Pause">
                        </div>
                
                        <div class="mb-3">
                            <label for="e3Days" class="form-label">E3-Days</label>
                            <input type="number" class="form-control" id="e3Days">
                        </div>
                        <div class="mb-3">
                            <label for="e3Start" class="form-label">E3-Start</label>
                            <input type="datetime-local" class="form-control" id="e3Start">
                        </div>
                        <div class="mb-3">
                            <label for="e3End" class="form-label">E3-End</label>
                            <input type="datetime-local" class="form-control" id="e3End">
                        </div>
                        <div class="mb-3">
                            <label for="e3Work" class="form-label">E3-Work</label>
                            <input type="number" class="form-control" id="e3Work">
                        </div>
                        <div class="mb-3">
                            <label for="e3Pause" class="form-label">E3-Pause</label>
                            <input type="number" class="form-control" id="e3Pause">
                        </div>
                
                        <div class="mb-3">
                            <label for="e4Days" class="form-label">E4-Days</label>
                            <input type="number" class="form-control" id="e4Days">
                        </div>
                        <div class="mb-3">
                            <label for="e4Start" class="form-label">E4-Start</label>
                            <input type="datetime-local" class="form-control" id="e4Start">
                        </div>
                        <div class="mb-3">
                            <label for="e4End" class="form-label">E4-End</label>
                            <input type="datetime-local" class="form-control" id="e4End">
                        </div>
                        <div class="mb-3">
                            <label for="e4Work" class="form-label">E4-Work</label>
                            <input type="number" class="form-control" id="e4Work">
                        </div>
                        <div class="mb-3">
                            <label for="e4Pause" class="form-label">E4-Pause</label>
                            <input type="number" class="form-control" id="e4Pause">
                        </div>
                
                        <!-- Month and Year -->
                        <div class="mb-3">
                            <label for="monthYear" class="form-label">Month-Year</label>
                            <input type="datetime-local" class="form-control" id="monthYear">
                        </div>
                
                        <button type="submit" class="btn btn-primary">Save</button>
                    </form>
                </div>
                
                
            </div>
        </div>
    </div>
    


<!-- Confirmation Modal -->
<div class="modal fade" id="confirmModal" tabindex="-1" aria-labelledby="confirmModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="confirmModalLabel">Confirm Changes</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                Are you sure you want to save these changes?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="confirmSave">Yes, Save</button>
            </div>
        </div>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
    const editButtons = document.querySelectorAll('.edit-btn');

    editButtons.forEach(button => {
        button.addEventListener('click', function () {
            const row = this.closest('tr');

            // Populate modal fields with data-* attributes
            document.getElementById('recordId').value = row.dataset.id;
            document.getElementById('company').value = row.dataset.company;
            document.getElementById('premiseName').value = row.dataset.premiseName;

            // Populate E1 to E4 fields
            document.getElementById('e1Days').value = row.dataset.e1Days;
            document.getElementById('e1Start').value = row.dataset.e1Start;
            document.getElementById('e1End').value = row.dataset.e1End;
            document.getElementById('e1Work').value = row.dataset.e1Work;
            document.getElementById('e1Pause').value = row.dataset.e1Pause;

            document.getElementById('e2Days').value = row.dataset.e2Days;
            document.getElementById('e2Start').value = row.dataset.e2Start;
            document.getElementById('e2End').value = row.dataset.e2End;
            document.getElementById('e2Work').value = row.dataset.e2Work;
            document.getElementById('e2Pause').value = row.dataset.e2Pause;

            document.getElementById('e3Days').value = row.dataset.e3Days;
            document.getElementById('e3Start').value = row.dataset.e3Start;
            document.getElementById('e3End').value = row.dataset.e3End;
            document.getElementById('e3Work').value = row.dataset.e3Work;
            document.getElementById('e3Pause').value = row.dataset.e3Pause;

            document.getElementById('e4Days').value = row.dataset.e4Days;
            document.getElementById('e4Start').value = row.dataset.e4Start;
            document.getElementById('e4End').value = row.dataset.e4End;
            document.getElementById('e4Work').value = row.dataset.e4Work;
            document.getElementById('e4Pause').value = row.dataset.e4Pause;

            // Populate Month and Year (in required format)
            let monthYear = row.dataset.monthYear; // Format: YYYY-MM-DD
            document.getElementById('monthYear').value = new Date(monthYear).toISOString().slice(0, 19); // Convert to ISO format
        });
    });

    document.getElementById('editForm').addEventListener('submit', function (e) {
        e.preventDefault();

        const updatedData = {
            id: document.getElementById('recordId').value,
            company: document.getElementById('company').value,
            premiseName: document.getElementById('premiseName').value,
            e1Days: document.getElementById('e1Days').value,
            e1Start: document.getElementById('e1Start').value,
            e1End: document.getElementById('e1End').value,
            e1Work: document.getElementById('e1Work').value,
            e1Pause: document.getElementById('e1Pause').value,
            e2Days: document.getElementById('e2Days').value,
            e2Start: document.getElementById('e2Start').value,
            e2End: document.getElementById('e2End').value,
            e2Work: document.getElementById('e2Work').value,
            e2Pause: document.getElementById('e2Pause').value,
            e3Days: document.getElementById('e3Days').value,
            e3Start: document.getElementById('e3Start').value,
            e3End: document.getElementById('e3End').value,
            e3Work: document.getElementById('e3Work').value,
            e3Pause: document.getElementById('e3Pause').value,
            e4Days: document.getElementById('e4Days').value,
            e4Start: document.getElementById('e4Start').value,
            e4End: document.getElementById('e4End').value,
            e4Work: document.getElementById('e4Work').value,
            e4Pause: document.getElementById('e4Pause').value,
            monthYear: document.getElementById('monthYear').value // Date in ISO format
        };

        fetch('/update-record', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(updatedData),
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('Record updated successfully!');
                location.reload(); // Refresh to reflect changes
            } else {
                alert('Error updating record.');
            }
        })
        .catch(err => console.error(err));
    });
});

</script>
      <!-- <script>
        document.addEventListener('DOMContentLoaded', function () {
    const editButtons = document.querySelectorAll('.edit-btn');

    editButtons.forEach(button => {
        button.addEventListener('click', function () {
            const row = this.closest('tr');

            // Populate modal fields with data-* attributes
            const fields = [
                'id', 'company', 'premiseName', 'model', 'color', 'sn', 'volume',
                'currentEo', 'balance', 'consumption', 'newEo', 'refilled',
                'scentEffectiveness', 'commonEncounters', 'otherRemarks', 'month', 'year'
            ];

            // Populate static fields
            fields.forEach(field => {
                const element = document.getElementById(field);
                if (element) {
                    element.value = row.dataset[field] || '';
                }
            });

            // Populate dynamic E1 to E4 fields
            for (let i = 1; i <= 4; i++) {
                const dynamicFields = ['Days', 'Start', 'End', 'Work', 'Pause'];
                dynamicFields.forEach(dynamicField => {
                    const fieldId = `e${i}${dynamicField}`;
                    const element = document.getElementById(fieldId);
                    if (element) {
                        element.value = row.dataset[fieldId] || '';
                    }
                });
            }
        });
    });

    document.getElementById('editForm').addEventListener('submit', function (e) {
        e.preventDefault();

        // Extract updated values
        const updatedData = {
            id: document.getElementById('recordId').value,
        };

        // Extract static fields
        const fields = [
            'company', 'premiseName', 'model', 'color', 'sn', 'volume',
            'currentEo', 'balance', 'consumption', 'newEo', 'refilled',
            'scentEffectiveness', 'commonEncounters', 'otherRemarks', 'month', 'year'
        ];

        fields.forEach(field => {
            const element = document.getElementById(field);
            if (element) {
                updatedData[field] = element.value;
            }
        });

        // Extract dynamic E1 to E4 fields
        for (let i = 1; i <= 4; i++) {
            const dynamicFields = ['Days', 'Start', 'End', 'Work', 'Pause'];
            dynamicFields.forEach(dynamicField => {
                const fieldId = `e${i}${dynamicField}`;
                const element = document.getElementById(fieldId);
                if (element) {
                    updatedData[fieldId] = element.value;
                }
            });
        }

        // Confirm update with another modal (or an alert)
        if (confirm('Are you sure you want to save the changes?')) {
            // Send data to the server (using Fetch API or AJAX)
            fetch('/update-data', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(updatedData),
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('Record updated successfully!');
                        location.reload(); // Refresh to reflect changes
                    } else {
                        alert('Error updating record.');
                    }
                })
                .catch(err => console.error(err));
        }
    });
});

      </script>
     -->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
