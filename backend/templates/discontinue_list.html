<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Inactive Devices</title>
  <link rel="icon" href="{{ url_for('static', filename='logo.jpg') }}" type="image/x-icon">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
  <div class="position-relative">
    <a href="{{ url_for('dashboard') }}" class="btn btn-secondary mb-3">Back to Dashboard</a>
    <h1>Inactive Devices</h1>
  </div>

  <form class="mb-4" method="get" action="/discontinue-list">
    <div class="accordion" id="filterAccordion">
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingOne">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne">
            Filter
          </button>
        </h2>
        <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#filterAccordion">
          <div class="accordion-body">
            <div class="row">
              <div class="col-md-3">
                <label class="form-label">Month (Need to input year also)</label>
                <input type="text" name="month" class="form-control" placeholder="6">
              </div>
              <div class="col-md-3">
                <label class="form-label">Year (Need to input month also)</label>
                <input type="number" name="year" class="form-control" placeholder="2025">
              </div>
              <div class="col-md-3">
                <label class="form-label">Company</label>
                <input type="text" name="company" class="form-control" placeholder="ABC Corp">
              </div>
              <div class="col-md-3">
                <label class="form-label">User</label>
                <input type="text" name="user" class="form-control" placeholder="admin1">
              </div>
              <div class="col-md-3">
                <label class="form-label">Change Scent?</label>
                <select name="change_scent" class="form-control">
                  <option value="">Any</option>
                  <option value="true">Yes</option>
                  <option value="false">No</option>
                </select>
              </div>
              <div class="col-md-3">
                <label class="form-label">Collect Back?</label>
                <select name="collect_back" class="form-control">
                  <option value="">Any</option>
                  <option value="true">Yes</option>
                  <option value="false">No</option>
                </select>
              </div>
              <div class="col-md-3 mt-3">
                <button type="submit" class="btn btn-primary w-100">Filter</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>

  <!-- Table -->
  <div class="table-responsive">
    <table class="table table-striped table-bordered">
      <thead class="table-dark">
        <tr>
          <th>User</th>
          <th>Company</th>
          <th>Date</th>
          <th>Premises</th>
          <th>Devices</th>
          <th>Change Scent</th>
          <th>Scent To</th>
          <th>Move Device</th>
          <th>To</th>
          <th>Relocate</th>
          <th>To</th>
          <th>Collect Back</th>
          <th>Remark</th>
          <th>Submitted At</th>
          <th>Collect Back Date</th>
        </tr>
      </thead>
      <tbody>
        {% for row in data %}
        <tr>
          <td>{{ row.user }}</td>
          <td>{{ row.company }}</td>
          <td>{{ row.date }}</td>
          <td>{{ row.premises }}</td>
          <td>{{ row.devices | join(', ') }}</td>
          <td>{{ row.change_scent }}</td>
          <td>{{ row.change_scent_to }}</td>
          <td>{{ row.move_device }}</td>
          <td>{{ row.move_device_to }}</td>
          <td>{{ row.relocate_device }}</td>
          <td>{{ row.relocate_device_to }}</td>
          <td>{{ row.collect_back }}</td>
          <td>{{ row.remark }}</td>
          <td>{{ row.submitted_at }}</td>
          <td>{{ row.collect_back_date_dt }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <nav>
    <ul class="pagination justify-content-center mt-4">
      <li class="page-item {% if page == 1 %}disabled{% endif %}">
        <a class="page-link" href="{{ pagination_base_url }}?{{ query_params | to_querystring | update_querystring('page', page - 1) }}">&laquo;</a>
      </li>
      {% for p in range(1, total_pages + 1) %}
        <li class="page-item {% if p == page %}active{% endif %}">
          <a class="page-link" href="{{ pagination_base_url }}?{{ query_params | to_querystring | update_querystring('page', p) }}">{{ p }}</a>
        </li>
      {% endfor %}
      <li class="page-item {% if page == total_pages %}disabled{% endif %}">
        <a class="page-link" href="{{ pagination_base_url }}?{{ query_params | to_querystring | update_querystring('page', page + 1) }}">&raquo;</a>
      </li>
    </ul>
  </nav>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
